<!DOCTYPE html>
<html>
<head>
    <title>Test Parcelles Cadastrales</title>
</head>
<body>
    <h1>üó∫Ô∏è Test d'impl√©mentation des Parcelles Cadastrales</h1>
    
    <h2>‚úÖ Nouvelles fonctionnalit√©s ajout√©es au MapComponent :</h2>
    
    <h3>üìù Nouveaux inputs :</h3>
    <ul>
        <li><code>@Input() chargerParcellesDynamiquement: boolean = false</code> - Active le chargement dynamique des parcelles cadastrales</li>
        <li><code>@Output() parcellesToggled = new EventEmitter&lt;boolean&gt;()</code> - √âv√©nement √©mis lors du toggle des parcelles</li>
    </ul>
    
    <h3>üîß Nouvelles propri√©t√©s priv√©es :</h3>
    <ul>
        <li><code>private parcellesLayer?: L.LayerGroup</code> - Couche Leaflet pour les parcelles</li>
        <li><code>private isLoadingParcelles = false</code> - √âtat de chargement</li>
        <li><code>private lastBboxParcelles?: string</code> - Cache de la derni√®re bbox charg√©e</li>
        <li><code>private loadingTimeoutParcelles?: any</code> - Timeout pour d√©bounce</li>
        <li><code>private minZoomParcelles = 15</code> - Zoom minimum (‚âà 1:2000√®me)</li>
    </ul>
    
    <h3>üöÄ Nouvelles m√©thodes :</h3>
    <ul>
        <li><code>setupDynamicParcellesLoading()</code> - Configure le chargement dynamique</li>
        <li><code>onMapViewChangedParcelles()</code> - Gestionnaire de changement de vue avec contrainte de zoom</li>
        <li><code>loadParcellesInCurrentView()</code> - Charge les parcelles via apiGeoParcellesUrl</li>
        <li><code>updateParcellesLayer()</code> - Met √† jour la couche</li>
        <li><code>addParcellesToLayer()</code> - Ajoute les parcelles √† la couche</li>
        <li><code>getParcelleStyle()</code> - Style orange vif pour les parcelles</li>
        <li><code>addParcellePopupAndTooltip()</code> - Popup avec infos cadastrales</li>
        <li><code>synchronizeParcellesLayer()</code> - Synchronisation programmatique</li>
        <li><code>toggleDynamicParcellesLoading()</code> - Toggle public</li>
        <li><code>reloadParcellesInCurrentView()</code> - Force le rechargement</li>
    </ul>
    
    <h3>üéØ Fonctionnalit√©s cl√©s :</h3>
    <ul>
        <li><strong>Contrainte de zoom :</strong> Les parcelles ne s'affichent qu'√† partir du zoom 15 (‚âà 1:2000√®me)</li>
        <li><strong>Chargement dynamique :</strong> Utilise <code>this.apiGeoParcellesUrl(bbox)</code> comme demand√©</li>
        <li><strong>D√©bounce :</strong> 500ms d'attente apr√®s mouvement pour √©viter trop de requ√™tes</li>
        <li><strong>Cache bbox :</strong> √âvite de recharger la m√™me zone</li>
        <li><strong>Style distinctif :</strong> Orange vif (#ff6b35) pour diff√©rencier des sites CENCA</li>
        <li><strong>Popup riche :</strong> Informations cadastrales (section, commune, surface, etc.)</li>
        <li><strong>Contr√¥le Layer :</strong> Int√©gr√© dans le s√©lecteur de couches "üó∫Ô∏è Parcelles Cadastrales"</li>
        <li><strong>EventEmitter :</strong> Communication bidirectionnelle avec composant parent</li>
    </ul>
    
    <h3>üìã Exemple d'utilisation :</h3>
    <pre><code>&lt;app-map 
  [mapName]="'test-parcelles'"
  [chargerParcellesDynamiquement]="true"
  (parcellesToggled)="onParcellesToggled($event)"&gt;
&lt;/app-map&gt;</code></pre>
    
    <h3>‚ö° Performance :</h3>
    <ul>
        <li>Zoom minimum requis pour √©viter surcharge serveur</li>
        <li>D√©bounce pour limiter les appels API</li>
        <li>Cache de bbox pour √©viter rechargements inutiles</li>
        <li>Nettoyage automatique de la couche si zoom insuffisant</li>
    </ul>
    
    <h3>üé® Style des parcelles :</h3>
    <ul>
        <li><strong>Couleur :</strong> Orange vif (#ff6b35)</li>
        <li><strong>√âpaisseur :</strong> 1.5px</li>
        <li><strong>Opacit√© :</strong> 80% contour, 10% remplissage</li>
        <li><strong>Popup :</strong> Ic√¥ne üó∫Ô∏è avec infos cadastrales</li>
        <li><strong>Tooltip :</strong> Num√©ro de parcelle au survol</li>
    </ul>
    
    <p><strong>‚úÖ Impl√©mentation termin√©e ! Le composant MapComponent supporte maintenant les parcelles cadastrales avec chargement dynamique et contrainte de zoom.</strong></p>
</body>
</html>